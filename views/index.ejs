<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inkwell ‚Äî Modern Blog</title>
  <link rel="stylesheet" href="./styles/styles.css" />
</head>
<body>


  <%- include("./includes/header.ejs") %>


  <main>

    <section class="hero-section">
      <div class="container">
        <p class="hero-label">Welcome to Inkwell</p>
        <h1 class="hero-title">
          Ideas worth<br><em>reading</em>, stories<br>worth sharing.
        </h1>
        <p class="hero-subtitle">
          A place for curious minds ‚Äî thoughtful essays, technical deep-dives,
          and everything in between.
        </p>
      </div>
    </section>

    <section class="container">
      <form action="/" method="GET" id="filterForm">
      <div class="filter-section">
        <div class="search-wrap">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg>
          <input
            type="search"
            name="search"
            class="search-input"
            placeholder="Search articles‚Ä¶"
            aria-label="Search articles"
            value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"
          />
        </div>

        <div class="category-tags" role="group" aria-label="Filter by category">
          <button type="submit" name="category" value="All" class="category-tag <%= !selectedCategory || selectedCategory === 'All' ? 'active' : '' %>">All</button>
          <button type="submit" name="category" value="Tech" class="category-tag <%= selectedCategory === 'Tech' ? 'active' : '' %>">Tech</button>
          <button type="submit" name="category" value="Life" class="category-tag <%= selectedCategory === 'Life' ? 'active' : '' %>">Life</button>
          <button type="submit" name="category" value="Design" class="category-tag <%= selectedCategory === 'Design' ? 'active' : '' %>">Design</button>
          <button type="submit" name="category" value="Travel" class="category-tag <%= selectedCategory === 'Travel' ? 'active' : '' %>">Travel</button>
        </div>

        <input type="hidden" name="page" value="1" id="pageInput"> 
      </div>
      </form>
    </section>


    <section class="posts-section container">
      <div class="section-header">
        <div>
          <h2>We have <%= totalBlogs %> articles</h2>
          <h2 class="section-title">Latest Articles</h2>
          <div class="divider"></div>
        </div>
        <% if (searchQuery || selectedCategory !== 'All') { %>
          <a href="/" class="clear-filters">
            Clear Filters
          <% } %>
      </div>


<% if (blogs.length > 0) { %>
      <div class="posts-grid featured-layout">
        <% blogs.forEach((blog, index) => { %>

          <article class="post-card <%= index === 0 && currentPage === 1 ? 'featured-post' : '' %>">
            <div class="card-image-placeholder" aria-hidden="true">
              <% if (blog.image) { %>
                <img src="<%= blog.image %>" alt="<%= blog.title %>" style="width: 100%; height: 100%; object-fit: cover;">
              <% } else { %>

                <%= 
                  blog.category === 'Tech' ? 'üíª' : 
                  blog.category === 'Life' ? 'üåø' : 
                  blog.category === 'Design' ? '‚úèÔ∏è' : 
                  blog.category === 'Travel' ? '‚úàÔ∏è' : 'üìù'
                %>
              <% } %>
            </div>
            <div class="card-body">
              <div class="card-meta">
                <span class="badge badge-<%= blog.category.toLowerCase() %>"><%= blog.category %></span>
                <time class="card-date" datetime="<%= blog.createdAt.split('T')[0] %>">
                  <%= new Date(blog.createdAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %>
                </time>
              </div>
              <h3 class="card-title">
                <a href="/post/<%= blog.id %>"><%= blog.title %></a>
              </h3>
              <p class="card-excerpt">
                <%= blog.content.substring(0, 150) %>...
              </p>
              <div class="card-footer">
                <a href="/post/<%= blog.id %>" class="read-more" aria-label="Read more about <%= blog.title %>">
                  Read More ‚Üí
                </a>

                <span style="font-size:0.78rem; color:var(--color-text-light);">‚ù§Ô∏è 0</span>
              </div>
            </div>
          </article>
        <% }); %>

      </div>


      <% if (totalPages > 1) { %>
        <nav class="pagination" aria-label="Blog post pages">
          <% if (currentPage > 1) { %>
            <a href="?page=<%= currentPage - 1 %><%= searchQuery ? '&search=' + searchQuery : '' %><%= selectedCategory !== 'All' ? '&category=' + selectedCategory : '' %>" class="page-btn" aria-label="Previous page">
              ‚Üê Previous
            </a>
          <% } else { %>
            <button class="page-btn" disabled aria-label="Previous page">
              ‚Üê Previous
            </button>
          <% } %>
          
          <span class="page-info">Page <%= currentPage %> of <%= totalPages %></span>
          
          <% if (currentPage < totalPages) { %>
            <a href="?page=<%= currentPage + 1 %><%= searchQuery ? '&search=' + searchQuery : '' %><%= selectedCategory !== 'All' ? '&category=' + selectedCategory : '' %>" class="page-btn" aria-label="Next page">
              Next ‚Üí
            </a>
          <% } else { %>
            <button class="page-btn" disabled aria-label="Next page">
              Next ‚Üí
            </button>
          <% } %>
        </nav>
      <% } %>
    <% } else { %>
      <div class="no-results">
        <h3>No articles found</h3>
        <p>Try adjusting your search or filter criteria</p>
        <a href="/" class="clear-filters-btn">View all articles</a>
      </div>
    <% } %>
  </section>
</main>

<%- include("./includes/footer.ejs") %>

<script src="./scripts/script.js"></script>